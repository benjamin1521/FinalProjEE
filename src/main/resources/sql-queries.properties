get.user.by.username.and.password=select * from users where username=? and password=?
get.user.by.id=select * from users where id=?
get.user.all=select * from users
get.reports.page.by.status=select reports.id, name, status, full_name_en, full_name_ua  from reports  join users on reports.client_id = users.id where (inspector_id=? or client_id=?) and status=? order by reports.id desc limit ?, ?
get.reports.page=select reports.id, name, status, full_name_en, full_name_ua  from reports  join users on reports.client_id = users.id where (inspector_id=? or client_id=?) order by reports.id desc limit ?, ?
get.inspectors=select * from users where role='Inspector'
create.user=insert into user (role, email, hash, full_name_ua, full_name_en, tax_code, person_type) values (?, ?, ?, ?, ?, ?, ?)
create.report=insert into reports (name, status, client_id, inspector_id) values (?, ?, ?, ?)


#foreign
#create.user=insert into user (role, email, hash, full_name_ua, full_name_en, tax_code, person_type) values (?, ?, ?, ?, ?, ?, ?)
#create.tax.return=insert into tax_return (customer_id, inspector_id, category_id, tax_return, status, last_update) values (?, ?, ?, ?, ?, ?)
#create.tax.return.update=insert into tax_return_update (tax_return_id, user_id, action, message, date) values (?, ?, ?, ?, ?)
#create.update.on.last.tax.return=insert into tax_return_update (tax_return_id, user_id, action, message, date) values (last_insert_id(), ?, ?, ?, ?)
#update.tax.return=update tax_return set status=?, last_update=? where id=?
#update.tax.return.inspector=update tax_return set inspector_id=?, status=?, last_update=? where id=?
#update.tax.return.json=update tax_return set tax_return=?, status=?, last_update=? where id=?
#get.last.update=select tax_return_update.id as update_id, action, message, date, user_id, user.role as user_role, user.email as user_email, user.full_name_ua as user_full_name_ua, user.full_name_en as user_full_name_en, user.tax_code as user_tax_code, user.person_type as user_person_type from tax_return_update join user on user.id=tax_return_update.user_id where tax_return_id=? order by date desc limit 1
#get.tax.returns.count=select count(*) from tax_return where customer_id=? or inspector_id=?
#get.tax.returns.count.by.status=select count(*) from tax_return where (customer_id=? or inspector_id=?) and status=?
#get.tax.returns.page=select tax_return.id, category.name, last_update, status, full_name_en, full_name_ua from tax_return join user on tax_return.customer_id = user.id join category on category.id=tax_return.category_id where inspector_id=? or customer_id=? order by last_update desc limit ?, ?
#get.tax.returns.page.by.status=select tax_return.id, category.name, last_update, status, full_name_en, full_name_ua from tax_return join user on tax_return.customer_id = user.id join category on category.id=tax_return.category_id where (inspector_id=? or customer_id=?) and status=? order by last_update desc limit ?, ?
#get.tax.return=select tax_return.id as tax_return_id, tax_return.status, tax_return.last_update, category.name as category, tax_return_update.id as update_id, tax_return_update.action, tax_return_update.message, tax_return_update.date, user.id as user_id, user.role as user_role, user.email as user_email, user.full_name_ua as user_full_name_ua, user.full_name_en as user_full_name_en, user.tax_code as user_tax_code, user.person_type as user_person_type, customer.id as customer_id, customer.role as customer_role, customer.email as customer_email, customer.full_name_ua as customer_full_name_ua, customer.full_name_en as customer_full_name_en, customer.tax_code as customer_tax_code, customer.person_type as customer_person_type, inspector.id as inspector_id, inspector.role as inspector_role, inspector.email as inspector_email, inspector.full_name_ua as inspector_full_name_ua, inspector.full_name_en as inspector_full_name_en, inspector.tax_code as inspector_tax_code, inspector.person_type as inspector_person_type from tax_return join tax_return_update on tax_return_update.tax_return_id=tax_return.id join category on category.id=tax_return.category_id join user on user.id=tax_return_update.user_id join user as customer on customer.id=tax_return.customer_id join user as inspector on inspector.id=tax_return.inspector_id where tax_return.id=? order by date
#get.json.tax.return=select tax_return from tax_return where (customer_id=? or inspector_id=?) and id=?
#get.inspector.for.new.tax.return=select user.id from user left join (select id, inspector_id from tax_return where status="AWAIT_INSPECTOR") as active_returns on active_returns.inspector_id=user.id left join inspector_category on inspector_category.inspector_id=user.id where role="INSPECTOR" and category_id=? group by user.id order by count(active_returns.id) limit 1
#get.new.inspector.for.tax.return=select user.id from user left join (select id, inspector_id from tax_return where status="AWAIT_INSPECTOR") as active_returns on active_returns.inspector_id=user.id left join inspector_category on inspector_category.inspector_id=user.id where role="INSPECTOR" and category_id=(select category_id from tax_return where id=?) and user.id not in (select user.id from tax_return_update join user on user.id=tax_return_update.user_id where tax_return_id=? and role="INSPECTOR") group by user.id order by count(active_returns.id) limit 1
